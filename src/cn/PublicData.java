/**
 * created 2020-11-18
 *
 * @by fan ou(1329650004@qq.com)
 *
 * Copy right 2020 fan ou
 *
 * Init by program and read only and save public data which can be used by all java file
 *
 */
package cn;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;
import java.util.List;

import java.util.logging.Logger;
import Logger.LogFatory;



public class PublicData {

    private static Map<String, String> sensitiveApiToPermissionMap;


    static {
        sensitiveApiToPermissionMap = new HashMap<>();
        List<String> list = Utils.fileRead(".//data//mapping_4.4.1.txt");
        // jump to second line
        for (int i=1;i<list.size();i++) {
            String[] s = list.get(i).trim().split(",");
            StringBuilder sb = new StringBuilder("");
            sb.append("L");
            sb.append(s[0]);
            sb.append(";->");
            sb.append(s[1]);
            sb.append(s[2]);
            String sensitiveApi = sb.toString();
            if (s[3].startsWith("android.permission.")) {
                int startIndex = s[3].lastIndexOf(".");
                //System.out.println("pscout permission:" + s[3].substring(startIndex + 1));
                sensitiveApiToPermissionMap.put(sensitiveApi, s[3].substring(startIndex + 1));
            }
        }
    }

    public static Map<String, String> getSensitiveApiToPermissionMapMap() {
        return sensitiveApiToPermissionMap;
    }
}
